<!DOCTYPE html>
<html>
<head>
    <title>Announcements</title>
</head>
<body>
    <h1>Announcements</h1>
    <ul id="list"></ul>

    <input type="text" id="announcement" placeholder="New announcement">
    <button onclick="postAnnouncement()">Post</button>

    <script>
    async function fetchAnnouncements() {
        let res = await fetch('/announcements');
        let data = await res.json();
        let list = document.getElementById('list');
        list.innerHTML = '';
        data.forEach(a => {
            let li = document.createElement('li');
            li.textContent = a.text;
            list.appendChild(li);
        });
    }

    async function postAnnouncement() {
        let text = document.getElementById('announcement').value;
        if(!text) return;
        await fetch('/announcements', {
            method: 'POST',
            headers: {'Content-Type': 'application/json'},
            body: JSON.stringify({text})
        });
        document.getElementById('announcement').value = '';
        fetchAnnouncements();
    }

    fetchAnnouncements();
    </script>
</body>
</html>
